{"version":"0.3.0","body":"/**\n * This script filters the appointment schedule into each appointment type based on calendar name.\n * https://learn.microsoft.com/en-us/javascript/api/office-scripts/excelscript/excelscript.filter?view=office-scripts\n * https://www.reddit.com/r/excel/comments/15nd5hb/cant_get_a_script_to_copy_and_paste_only_visible/\n */\n\n\nfunction main(workbook: ExcelScript.Workbook) {\n    \n    FilterSchedule(workbook, \"*Internal*\", \"Internal Medicine\");\n    FilterSchedule(workbook, \"*Procedure*\", \"Procedure\");\n\n\n}\n\nfunction FilterSchedule(workbook: ExcelScript.Workbook, filterCriteria: string, newSheetName: string) {\n    const table = workbook.getActiveWorksheet().getTables()[0];\n    let thisSheet = workbook.getActiveWorksheet();\n\n\n    // Get the filter for the \"Calendar Name\" table column.\n    const pageViewFilter: ExcelScript.Filter = table.getColumnByName(\"Calendar Name\").getFilter();\n\n    // Filter Internal Medicine appointments and create new worksheet.\n    pageViewFilter.applyCustomFilter(filterCriteria);\n\n    let usedRange = thisSheet.getUsedRange();\n    let values = usedRange.getValues();\n\n    const source = table.getRange().getSpecialCells(ExcelScript.SpecialCellType.visible);\n\n    let sheetExists = workbook.getWorksheet(newSheetName);\n\n    if (sheetExists) {\n        let usedRange = sheetExists.getUsedRange();\n\n        if (usedRange) {\n            usedRange.clear();\n        }\n        sheetExists.getRange(\"A1\").copyFrom(source, ExcelScript.RangeCopyType.all);\n\n    }\n\n    else {\n\n        let newSheet = workbook.addWorksheet(newSheetName);\n        newSheet.getRange(\"A1\").copyFrom(source, ExcelScript.RangeCopyType.all);\n\n    }\n\n    pageViewFilter.clear();\n}","description":"","noCodeMetadata":"","parameterInfo":"{\"version\":1,\"originalParameterOrder\":[],\"parameterSchema\":{\"type\":\"object\",\"default\":{},\"x-ms-visibility\":\"internal\"},\"returnSchema\":{\"type\":\"object\",\"properties\":{}},\"signature\":{\"comment\":\"This script filters the appointment schedule into each appointment type based on calendar name.\\nhttps://learn.microsoft.com/en-us/javascript/api/office-scripts/excelscript/excelscript.filter?view=office-scripts\\nhttps://www.reddit.com/r/excel/comments/15nd5hb/cant_get_a_script_to_copy_and_paste_only_visible/\",\"parameters\":[{\"name\":\"workbook\",\"comment\":\"\"}]}}","apiInfo":"{\"variant\":\"synchronous\",\"variantVersion\":2}"}